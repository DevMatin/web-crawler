-- ============================================
-- 00_extensions_and_enums.sql
-- Basis: Extensions + ENUM-Typen
-- ============================================

-- =======================
-- üì¶ EXTENSIONS
-- =======================
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
CREATE EXTENSION IF NOT EXISTS "vector";

-- =======================
-- üî§ ENUM TYPES
-- =======================
-- Content-Aufgabentypen (f√ºr content_tasks.task_type)
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'task_type') THEN
    CREATE TYPE task_type AS ENUM ('article', 'content-refresh', 'page-update', 'meta-update');
  END IF;
END$$;

-- Status f√ºr Tasks (f√ºr content_tasks.status)
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'task_status') THEN
    CREATE TYPE task_status AS ENUM ('pending','in_progress','completed','failed','cancelled');
  END IF;
END$$;

-- Status f√ºr Content (f√ºr generated_content.status)
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'content_status') THEN
    CREATE TYPE content_status AS ENUM ('draft', 'published', 'archived');
  END IF;
END$$;

-- Redirect-Typen (f√ºr slug_history.redirect_type)
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'redirect_type') THEN
    CREATE TYPE redirect_type AS ENUM ('301', '302');
  END IF;
END$$;

-- Quelle f√ºr Performance-Daten (f√ºr content_performance.source)
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'perf_source') THEN
    CREATE TYPE perf_source AS ENUM ('GSC', 'GA', 'internal');
  END IF;
END$$;
